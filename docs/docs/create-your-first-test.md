---
sidebar_position: 2
---

# Create your first test

## Setup your test file

If you didn't change the base folder in your setup test file :

```javascript
import { loadStepsJest } from "specflow-emulator";

loadStepsJest();
```

That's mean, you will have to create a folder `__features__` inside `src`, then you can create folders or directly create test files.

`specflow-emulator` provide a new way to use `cucumber` and `jest-cucumber`, first you will have to create a test file name like: `nameOfYourFile.steps.js`.

```javascript
// nameOfYourFile.steps.js
import { defineFeature } from "specflow-emulator";

// Here you can change the path to your .feature file
defineFeature("./nameOfYourFile.feature");
```

## Creating the feature file

Then create your scenario inside your `.feature`, like this basic scenario:

```shell
Feature: Simple Calculator

    Scenario: Simple addition
        Given number "2"
        And number "1"
        When I add them
        Then the result should be "3"

    Scenario: Simple multiplication
        Given number "5"
        And number "2"
        When I multiple them
        Then the result should be "10"
```

## Creating the step definitions file

Create a `YourFileName.stepdefinitions.js` file that will contains your steps, first you will have to import `defineSteps` from `specflow-emulator`:

```javascript
import { defineSteps } from "specflow-emulator";

export const stepDefinitions = defineSteps();
```

:::danger Exporting
Don't forget to export this const in order to provide the steps to `specflow-emulator`, if you don't do that, it will never be possible to provide your steps to the pool.
:::

### Usage

You will need to provide two argument to `defineSteps` function, the first one is an array of object, provide inside the feature argument the real name of your scenario, the second argument is a callback that give you Given | When | Then function used them to bind those function with the feature file, With our example it would be like this:

```javascript
export const stepDefinitions = defineSteps(
  [{ feature: "Simple Calculator", tag: "feature" }],
  ({ Given, When, Then }) => {

  }
```

`Given`, `When`, `Then` functions take two callback, the first one is generated by `specflow-emulator` that gave you a scenarioContext, in order to share between step datas, the second one is your variables coming from the scenario itself, if you got 2 variables, you will need to provide two argument to the function.

In our case, it would be like this:

```javascript
import { defineSteps } from "specflow-emulator";

export const stepDefinitions = defineSteps(
  [{ feature: "Simple Calculator", tag: "feature" }],
  ({ Given, When, Then }) => {
    Given(/^number "(.*)"$/, (scenarioContext) => (number) => {
      if (scenarioContext.number) {
        scenarioContext.number.push(number);
      } else {
        scenarioContext.number = [number];
      }
    });

    When("I add them", (scenarioContext) => (number) => {
      scenarioContext.result =
        +scenarioContext.number[0] + +scenarioContext.number[1];
    });

    When("I multiple them", (scenarioContext) => (number) => {
      scenarioContext.result =
        +scenarioContext.number[0] * +scenarioContext.number[1];
    });

    Then(/^the result should be "(.*)"$/, (scenarioContext) => (number) => {
      expect(scenarioContext.result).toBe(+number);
    });
  }
);
```
